app.factory('BeadManager', ['$q', function($q) {
    var BeadManager = {
      palette : [{"name":"white","code":"H01","special":"","type":"Hama","hex":"#ECEDED","lab":[93.67401113061766,-0.32837969577204085,-0.12712286155056596],"enabled":true},{"name":"Cream","code":"H02","special":"","type":"Hama","hex":"#F0E8B9","lab":[91.56864814340003,-4.619622877406915,23.884954451406195],"enabled":true},{"name":"yellow","code":"H03","special":"","type":"Hama","hex":"#F0B901","lab":[78.00787731865218,7.085474995233321,80.12171801173756],"enabled":true},{"name":"orange","code":"H04","special":"","type":"Hama","hex":"#E64F27","lab":[54.61770631891365,56.689876394844184,53.18692058104152],"enabled":true},{"name":"red","code":"H05","special":"","type":"Hama","hex":"#B63136","lab":[41.857435149033144,53.15223192632099,29.223867236548486],"enabled":true},{"name":"pink","code":"H06","special":"","type":"Hama","hex":"#E1889F","lab":[66.61080558367084,36.80496228305491,2.438359208183094],"enabled":true},{"name":"purple","code":"H07","special":"","type":"Hama","hex":"#694A82","lab":[36.952916224847925,24.686183130561147,-26.604051026125887],"enabled":true},{"name":"Dark Blue (Blue)","code":"H08","special":"","type":"Hama","hex":"#2C4690","lab":[31.64565990187117,16.127927543180544,-43.947413848093696],"enabled":true},{"name":"Light Blue","code":"H09","special":"","type":"Hama","hex":"#305CB0","lab":[40.27453970594125,14.27441552788869,-49.25213620153753],"enabled":true},{"name":"Green","code":"H10","special":"","type":"Hama","hex":"#256847","lab":[39.15425318222347,-29.652438073700772,12.476852159024299],"enabled":true},{"name":"light green","code":"H11","special":"","type":"Hama","hex":"#49AE89","lab":[64.55949726134295,-38.3990198380989,10.288002806094587],"enabled":true},{"name":"brown","code":"H12","special":"","type":"Hama","hex":"#534137","lab":[29.147092870469244,6.101128943827305,9.060484355574117],"enabled":true},{"name":"transparent red","code":"H13","special":"Transp","type":"Hama","hex":"#C02435","lab":[42.34633253216157,60.13782629495512,30.882329294570145],"enabled":true},{"name":"transparent green","code":"H16","special":"Transp","type":"Hama","hex":"#37B876","lab":[66.8253469349222,-50.07560676724343,23.679230484503844],"enabled":true},{"name":"grey","code":"H17","special":"","type":"Hama","hex":"#83888A","lab":[56.35571613233206,-1.4256974485736817,-1.7160775233100445],"enabled":true},{"name":"black","code":"H18","special":"","type":"Hama","hex":"#2E2F31","lab":[19.373186310588544,0.04583330242860506,-1.4366407370057566],"enabled":true},{"name":"Clear","code":"H19","special":"Transp","type":"Hama","hex":"#D8D2CE","lab":[84.56012203035468,1.3596133550963785,2.6998699344031207],"enabled":true},{"name":"Reddish Brown","code":"H20","special":"","type":"Hama","hex":"#7F332A","lab":[31.913318542225497,32.27390680811126,22.169513979866085],"enabled":true},{"name":"light brown","code":"H21","special":"","type":"Hama","hex":"#A5693F","lab":[50.05097863606561,19.787542644312428,33.25020483454875],"enabled":true},{"name":"Dark Red","code":"H22","special":"","type":"Hama","hex":"#A52D36","lab":[38.09688206023597,49.20514900434064,23.890921760079554],"enabled":true},{"name":"Translucent purple","code":"H24","special":"Transp","type":"Hama","hex":"#683E9A","lab":[35.4422600729857,37.61542286249275,-43.66071364738862],"enabled":true},{"name":"Translucent Brown","code":"H25","special":"Transp","type":"Hama","hex":"#87593D","lab":[42.204329626417255,15.708082639787902,23.849839740234934],"enabled":true},{"name":"Flesh","code":"H26","special":"","type":"Hama","hex":"#DE9B90","lab":[70.16604376870707,23.64439013243258,15.831939862605982],"enabled":true},{"name":"Beige","code":"H27","special":"","type":"Hama","hex":"#DEB48B","lab":[76.09147007265506,9.634808044785114,26.656136117446504],"enabled":true},{"name":"Army (Dark Green)","code":"H28","special":"","type":"Hama","hex":"#363F38","lab":[25.63793644631543,-5.373170492013607,3.04026448345881],"enabled":true},{"name":"Claret","code":"H29","special":"","type":"Hama","hex":"#B9395E","lab":[44.30268474319296,53.85439774635348,7.912680961763064],"enabled":true},{"name":"burgundy","code":"H30","special":"","type":"Hama","hex":"#592F38","lab":[25.08316679705314,20.332085735943693,2.774965601763124],"enabled":true},{"name":"Turquoise","code":"H31","special":"","type":"Hama","hex":"#6797AE","lab":[59.954428742980014,-10.048472965368981,-17.111400650800768],"enabled":true},{"name":"Neon Pink (Fucsia)","code":"H32","special":"","type":"Hama","hex":"#FF208D","lab":[56.303522588247716,82.50881616702799,-1.6364042547914792],"enabled":true},{"name":"Cerise","code":"H33","special":"","type":"Hama","hex":"#FF3956","lab":[56.93693948730801,73.52478778743443,31.868779460396045],"enabled":true},{"name":"Neon Yellow","code":"H34","special":"Transp","type":"Hama","hex":"#E5EF13","lab":[90.9794162322205,-24.48314767318366,87.4519174887362],"enabled":true},{"name":"Neon Red","code":"H35","special":"Transp","type":"Hama","hex":"#FF2833","lab":[55.08943232098477,76.21201779746673,49.40807459862345],"enabled":true},{"name":"Neon Blue","code":"H36","special":"Transp","type":"Hama","hex":"#2353B0","lab":[37.25898887321658,18.61243709359603,-54.142541201652975],"enabled":true},{"name":"Neon Green","code":"H37","special":"Transp","type":"Hama","hex":"#06B73C","lab":[65.14625319885191,-63.5743061647252,49.8438955471572],"enabled":true},{"name":"Neon Orange","code":"H38","special":"Transp","type":"Hama","hex":"#FD8600","lab":[67.97108796425668,39.06424886595439,74.43413237425901],"enabled":true},{"name":"Fluorescent Yellow","code":"H39","special":"","type":"Hama","hex":"#F1F21C","lab":[92.70220716357323,-20.832818735196213,87.97150626068111],"enabled":true},{"name":"Fluorescent Orange","code":"H40","special":"","type":"Hama","hex":"#FE630B","lab":[61.67033036301642,56.049723905133575,69.02790929814047],"enabled":true},{"name":"Fluorescent Blue","code":"H41","special":"","type":"Hama","hex":"#2659B2","lab":[39.19237284534718,15.742961084335677,-52.192267531120216],"enabled":true},{"name":"Fluorescent Green","code":"H42","special":"","type":"Hama","hex":"#0CBD51","lab":[67.32759301905932,-62.598517447849446,42.97856792737376],"enabled":true},{"name":"pastel yellow","code":"H43","special":"","type":"Hama","hex":"#F0EA37","lab":[90.61845717050542,-16.69239303332326,80.25500385931421],"enabled":true},{"name":"Pastel Red","code":"H44","special":"","type":"Hama","hex":"#EE6972","lab":[61.216200926711934,52.04326974573448,20.729836089773123],"enabled":true},{"name":"Pastel Purple","code":"H45","special":"","type":"Hama","hex":"#886DB9","lab":[51.4669526308854,26.878257723571664,-36.326317157221546],"enabled":true},{"name":"pastel blue","code":"H46","special":"","type":"Hama","hex":"#629ED7","lab":[63.30706973889444,-3.197059037650718,-34.970257739455036],"enabled":true},{"name":"pastel green","code":"H47","special":"","type":"Hama","hex":"#83CB70","lab":[75.26869435575726,-39.71836982726074,38.321892688646365],"enabled":true},{"name":"Pastel Pink","code":"H48","special":"","type":"Hama","hex":"#CF70B7","lab":[60.13425304968318,46.758997722410875,-21.101814508149587],"enabled":true},{"name":"Azure","code":"H49","special":"","type":"Hama","hex":"#4998BC","lab":[59.43776044516926,-13.345878473561223,-25.934942022052688],"enabled":true},{"name":"Black","code":"N01","special":"","type":"Nabbi","hex":"#3A3D41","lab":[25.61954475398874,-0.30178428011129466,-2.894133621177053],"enabled":true},{"name":"Dark Brown","code":"N02","special":"","type":"Nabbi","hex":"#50443B","lab":[29.801398642375432,3.472641680917987,7.343896516128923],"enabled":true},{"name":"Brown Medium","code":"N03","special":"","type":"Nabbi","hex":"#5A3E36","lab":[29.121094583706324,11.07628875975858,9.803786578271922],"enabled":true},{"name":"Maroon (Wine Red)","code":"N04","special":"","type":"Nabbi","hex":"#813547","lab":[33.282231813013695,34.61551766842636,5.47522429280548],"enabled":true},{"name":"Caramel","code":"N05","special":"","type":"Nabbi","hex":"#A76224","lab":[48.35845439757483,23.04186513076978,45.156592451798886],"enabled":true},{"name":"Tan (Beige)","code":"N06","special":"","type":"Nabbi","hex":"#AD967E","lab":[63.510544156197994,4.776032980204292,15.817939131161118],"enabled":true},{"name":"Sand (Skin)","code":"N07","special":"","type":"Nabbi","hex":"#EEB182","lab":[76.82001158926235,16.598714227755053,32.68711201071333],"enabled":true},{"name":"Ash (Ash Grey","code":"N08","special":"","type":"Nabbi","hex":"#8D8B7F","lab":[57.713159870182295,-1.4895848508776344,6.675709442605582],"enabled":true},{"name":"Hunter Green","code":"N09","special":"","type":"Nabbi","hex":"#2F4A39","lab":[28.895210771765313,-14.533346487029004,6.949909753729111],"enabled":true},{"name":"Light Grey","code":"N10","special":"","type":"Nabbi","hex":"#D3CBCB","lab":[82.31018060214703,2.769538655724879,0.9773925723753241],"enabled":true},{"name":"Purple","code":"N11","special":"","type":"Nabbi","hex":"#644591","lab":[36.00335426545387,30.07948846095182,-37.32287942781565],"enabled":true},{"name":"Ivory","code":"N12","special":"","type":"Nabbi","hex":"#E2D0BF","lab":[84.50542025836998,3.4834664546689598,10.688126502744556],"enabled":true},{"name":"Orange (Clear Orange)","code":"N13","special":"","type":"Nabbi","hex":"#F3601B","lab":[59.433902046576776,53.69518355998631,62.666027447948316],"enabled":true},{"name":"Yellow","code":"N14","special":"","type":"Nabbi","hex":"#F9CA00","lab":[83.11551176818837,2.1421866328201755,84.19402241759589],"enabled":true},{"name":"White","code":"N15","special":"","type":"Nabbi","hex":"#F4F4F3","lab":[96.16473096664049,-0.17104927536104597,0.4702173843151414],"enabled":true},{"name":"Green","code":"N16","special":"","type":"Nabbi","hex":"#297A3B","lab":[45.2292086674059,-38.89957272535313,27.323518985846206],"enabled":true},{"name":"Bright Blue (Blue)","code":"N17","special":"","type":"Nabbi","hex":"#3B75CB","lab":[49.45263682759895,9.94475814379847,-50.174384502106626],"enabled":true},{"name":"Light Rose (Light Pink)","code":"N18","special":"","type":"Nabbi","hex":"#E1B4AB","lab":[77.03523497636952,14.94255040084147,10.769183269015613],"enabled":true},{"name":"Red (Light Red)","code":"N19","special":"","type":"Nabbi","hex":"#DF2638","lab":[48.71013029919783,68.32578842095522,38.02449053270848],"enabled":true},{"name":"Light Brown","code":"N20","special":"","type":"Nabbi","hex":"#B58B69","lab":[61.053299325769814,11.44867056551291,24.325473574885947],"enabled":true},{"name":"Lt Yellow","code":"N21","special":"","type":"Nabbi","hex":"#F5EC8D","lab":[92.27677122624162,-9.949555172078739,47.02103191880169],"enabled":true},{"name":"Lime (pearl Green)","code":"N22","special":"","type":"Nabbi","hex":"#48AF4F","lab":[63.83748491522306,-49.66665479411875,40.01738057400637],"enabled":true},{"name":"Med Blue (pastel blue)","code":"N23","special":"","type":"Nabbi","hex":"#71A3E6","lab":[66.07302221935075,1.833597690188371,-38.888204308025195],"enabled":true},{"name":"Lavender","code":"N24","special":"","type":"Nabbi","hex":"#B6A0DB","lab":[69.6125724704404,19.660542555967442,-26.976163537355234],"enabled":true},{"name":"Pink (old rose)","code":"N25","special":"","type":"Nabbi","hex":"#EE6A97","lab":[62.2701918401053,55.19144133534887,0.9006256658574241],"enabled":true},{"name":"Peach (Light orange)","code":"N26","special":"","type":"Nabbi","hex":"#FCA879","lab":[76.11906602190228,26.053002518897195,36.8166944207059],"enabled":true},{"name":"Chocolate","code":"N27","special":"","type":"Nabbi","hex":"#875F52","lab":[44.153248252557724,14.516060586468871,13.925657683035709],"enabled":true},{"name":"Sky (light blue)","code":"N28","special":"","type":"Nabbi","hex":"#A7C6F1","lab":[79.01506930456323,-0.58894849635166,-24.62942161977717],"enabled":true},{"name":"Gold/Orange (Pearl Orange)","code":"N29","special":"","type":"Nabbi","hex":"#EE9527","lab":[69.3400752651557,25.77801113628153,66.40796813944362],"enabled":true},{"name":"Kiwi (Olive)","code":"N30","special":"","type":"Nabbi","hex":"#C7BF5E","lab":[76.19912215580143,-10.022510625894155,49.29633253459382],"enabled":true},{"name":"White","code":"P01","special":"","type":"Perler","hex":"#F1F1F1","lab":[95.14503889510985,0.005040331659267316,-0.009972569602512138],"enabled":true},{"name":"Cream","code":"P02","special":"","type":"Perler","hex":"#E0DEA9","lab":[87.46285794952743,-7.66247426950234,26.32036239323177],"enabled":true},{"name":"Yellow","code":"P03","special":"","type":"Perler","hex":"#ECD800","lab":[85.47596127130431,-10.51842116190299,85.31612910004736],"enabled":true},{"name":"Orange","code":"P04","special":"","type":"Perler","hex":"#ED6120","lab":[58.656607546022244,51.20634524623874,59.91887425252814],"enabled":true},{"name":"Red","code":"P05","special":"","type":"Perler","hex":"#BF2E40","lab":[43.360637495835945,57.45645172362035,25.384100511266617],"enabled":true},{"name":"Bubblegum","code":"P06","special":"","type":"Perler","hex":"#DD669B","lab":[59.197154688055235,52.08186861226666,-6.214929751820719],"enabled":true},{"name":"Purple","code":"P07","special":"","type":"Perler","hex":"#604089","lab":[33.89887840524948,29.848778809858118,-35.80277777992706],"enabled":true},{"name":"Dark Blue","code":"P08","special":"","type":"Perler","hex":"#2B3F87","lab":[28.948248562367212,17.29714623543563,-42.756272722046894],"enabled":true},{"name":"Light Blue","code":"P09","special":"","type":"Perler","hex":"#3370C0","lab":[47.102694809161335,7.905305589542111,-47.630723335883765],"enabled":true},{"name":"Dark Green","code":"P10","special":"","type":"Perler","hex":"#1C753E","lab":[43.237434729505694,-38.894536899753305,23.089864359405745],"enabled":true},{"name":"Pearl Coral","code":"P100","special":"Pearl","type":"Perler","hex":"#F97E79","lab":[66.85621323615104,46.431845396851855,24.63312028116702],"enabled":true},{"name":"Pearl Light Blue","code":"P101","special":"Pearl","type":"Perler","hex":"#7AAEA2","lab":[67.2907680144048,-19.780222391785564,0.6483585624574406],"enabled":true},{"name":"Pearl Green","code":"p102","special":"Pearl","type":"Perler","hex":"#84B791","lab":[70.04740589808851,-24.659987177843455,14.010505993955015],"enabled":true},{"name":"Pearl Yellow","code":"P103","special":"Pearl","type":"Perler","hex":"#CAC033","lab":[76.37199897912893,-11.939894677273132,67.34466856317452],"enabled":true},{"name":"Pearl Light Pink","code":"P104","special":"Pearl","type":"Perler","hex":"#D7A8A2","lab":[72.9320232158228,16.355571056224427,9.708941757628153],"enabled":true},{"name":"Silver","code":"P105","special":"Metal","type":"Perler","hex":"#777B81","lab":[51.46527699044114,-0.23494345480401524,-3.789749681026988],"enabled":true},{"name":"Light Green","code":"P11","special":"","type":"Perler","hex":"#56BA9F","lab":[69.18328156798873,-35.85006725993362,4.847847323875487],"enabled":true},{"name":"Brown","code":"P12","special":"","type":"Perler","hex":"#513931","lab":[26.440253101273953,9.411974579588477,9.185113303421844],"enabled":true},{"name":"Grey","code":"P17","special":"","type":"Perler","hex":"#8A8D91","lab":[58.506162084990734,-0.28930630919277167,-2.5145476802308053],"enabled":true},{"name":"Black","code":"P18","special":"","type":"Perler","hex":"#2E2F32","lab":[19.40865458976276,0.2941760124334225,-2.0740875690798966],"enabled":true},{"name":"Rust","code":"P20","special":"","type":"Perler","hex":"#8C372C","lab":[34.98256404791403,35.4358514554691,25.196587503069512],"enabled":true},{"name":"Light Brown","code":"P21","special":"","type":"Perler","hex":"#815D34","lab":[42.37459397789458,9.824023641757606,29.062000386771437],"enabled":true},{"name":"Peach","code":"P33","special":"","type":"Perler","hex":"#EEBAB2","lab":[79.90280626029264,17.570855022003062,11.235334537437435],"enabled":true},{"name":"Tan","code":"P35","special":"","type":"Perler","hex":"#BC9371","lab":[63.95883012811551,10.818937211142076,23.897900467198106],"enabled":true},{"name":"Magenta","code":"P38","special":"","type":"Perler","hex":"#F22A7B","lab":[53.98797427791317,76.18357009463011,5.453599959595157],"enabled":true},{"name":"Neon Yellow","code":"P47","special":"Transp","type":"Perler","hex":"#DCE002","lab":[86.27144408722373,-21.20557593163025,85.1299288713242],"enabled":true},{"name":"Neon Orange","code":"P48","special":"Transp","type":"Perler","hex":"#FF7700","lab":[65.32106828573289,47.198661167579814,73.01591433372771],"enabled":true},{"name":"Neon Green","code":"P49","special":"Transp","type":"Perler","hex":"#019E43","lab":[56.94405870249116,-55.141559530922976,37.337186233795336],"enabled":true},{"name":"Neon Pink","code":"P50","special":"Transp","type":"Perler","hex":"#FF3991","lab":[58.255279240332854,77.59127486721535,-1.1408561944657114],"enabled":true},{"name":"Pastel Blue","code":"P52","special":"","type":"Perler","hex":"#5390D1","lab":[58.404428595288934,-0.13968866237246136,-39.33344075219347],"enabled":true},{"name":"Pastel Green","code":"P53","special":"","type":"Perler","hex":"#76C882","lab":[74.04357246760509,-39.72356387029813,27.383415463882766],"enabled":true},{"name":"Pastel Lavender","code":"P54","special":"","type":"Perler","hex":"#8A72C1","lab":[53.263432225548385,26.541601966264704,-38.08886300507825],"enabled":true},{"name":"Pastel Yellow","code":"P56","special":"","type":"Perler","hex":"#FEF875","lab":[95.78481341272857,-14.411569522407907,62.57573634908047],"enabled":true},{"name":"Chedder","code":"P57","special":"","type":"Perler","hex":"#F1AA0C","lab":[74.49370498679338,15.487655196791739,76.52350892354065],"enabled":true},{"name":"Toothpaste","code":"P58","special":"","type":"Perler","hex":"#93C8D4","lab":[77.439064736401,-14.30031159909978,-11.533850293931813],"enabled":true},{"name":"Hot Coral","code":"P59","special":"","type":"Perler","hex":"#FF3851","lab":[56.76467850872049,73.55669109638858,34.557072448313576],"enabled":true},{"name":"Plum","code":"P60","special":"","type":"Perler","hex":"#A24B9C","lab":[45.78971996773123,47.115057160519115,-27.992535086967262],"enabled":true},{"name":"Kiwi Lime","code":"P61","special":"","type":"Perler","hex":"#6CBE13","lab":[69.51371977838028,-49.45497220378042,67.14119657127394],"enabled":true},{"name":"Cyan (aka Turquoise)","code":"P62","special":"","type":"Perler","hex":"#2B89C6","lab":[54.53485861303203,-5.966964371683203,-39.29781678026265],"enabled":true},{"name":"Blush","code":"P63","special":"","type":"Perler","hex":"#FF8285","lab":[68.69234679803225,47.66795459780104,20.549476797367184],"enabled":true},{"name":"Periwinkle Blue","code":"P70","special":"","type":"Perler","hex":"#647CBE","lab":[52.7765054770709,9.41223329760954,-37.340056382628475],"enabled":true},{"name":"Glow Green","code":"P75","special":"Glow","type":"Perler","hex":"#BEC696","lab":[78.19117431923762,-10.79303776799756,23.19363708778377],"enabled":true},{"name":"Light Pink","code":"P79","special":"","type":"Perler","hex":"#F6B3DD","lab":[80.20966919709191,30.683794259930675,-11.437852132851445],"enabled":true},{"name":"Bright Green","code":"P80","special":"","type":"Perler","hex":"#4FAD42","lab":[63.29554124869864,-48.66313756987067,45.55685312117541],"enabled":true},{"name":"Light Gray","code":"P81","special":"","type":"Perler","hex":"#B1B5B2","lab":[73.29123768376007,-1.9601440299652495,1.0275936576882305],"enabled":true},{"name":"Evergreen","code":"P??","special":"","type":"Perler","hex":"#355343","lab":[32.58778180971992,-15.165154177891937,5.8688568096112785],"enabled":true},{"name":"Lavender","code":"P82","special":"","type":"Perler","hex":"#AD98D4","lab":[66.59181905288467,19.77083620081077,-27.820377283319143],"enabled":true},{"name":"Pink","code":"P83","special":"","type":"Perler","hex":"#E44892","lab":[55.28188017447104,65.878961403179,-6.6480127564711555],"enabled":true},{"name":"Gold","code":"P85","special":"Metal","type":"Perler","hex":"#BB7634","lab":[55.856366650883004,21.34222043124334,46.19854292613178],"enabled":true},{"name":"Raspberry","code":"P88","special":"","type":"Perler","hex":"#A53061","lab":[39.540533162907145,51.57192689055945,-1.289394608797667],"enabled":true},{"name":"Butterscotch","code":"P90","special":"","type":"Perler","hex":"#D48437","lab":[62.3175843016583,24.496344234048394,52.49445057308758],"enabled":true},{"name":"Parrot Green","code":"P91","special":"","type":"Perler","hex":"#067C81","lab":[47.025614399653556,-26.202741801419155,-10.914095973889282],"enabled":true},{"name":"Dark Grey","code":"P92","special":"","type":"Perler","hex":"#4D5156","lab":[34.261494221043414,-0.4578036367013649,-3.4851404925629326],"enabled":true},{"name":"Blueberry Cream","code":"P93","special":"","type":"Perler","hex":"#8297D9","lab":[63.25086997345939,9.100694442175538,-36.03389012190059],"enabled":true},{"name":"Cranapple","code":"P96","special":"","type":"Perler","hex":"#803245","lab":[32.48048887895449,35.55441153944194,5.609099683503893],"enabled":true},{"name":"Prickly Pear","code":"P97","special":"","type":"Perler","hex":"#BDDA01","lab":[82.35928648305362,-31.21948561568938,81.29171919711541],"enabled":true},{"name":"Sand","code":"P98","special":"","type":"Perler","hex":"#E4B690","lab":[77.25900360205121,11.514953990928555,25.66304766106251],"enabled":true},{"name":"White","code":"S01/R01","special":"","type":"Artkal","hex":"#E9E7E6","lab":[91.76943349093582,0.4996802976685588,0.7127870821908466],"enabled":true},{"name":"Burning Sand","code":"S02/R02","special":"","type":"Artkal","hex":"#FE908F","lab":[71.55532276207718,41.28383212603715,18.89858729709186],"enabled":true},{"name":"Tangerine","code":"S03/R03","special":"","type":"Artkal","hex":"#FEA402","lab":[74.58850537809668,24.055331574561357,78.44212136114224],"enabled":true},{"name":"Orange","code":"S04/R04","special":"","type":"Artkal","hex":"#FD6149","lab":[61.579148053241084,58.12871745345205,44.576503235077844],"enabled":true},{"name":"Tall Poppy","code":"S05/R05","special":"","type":"Artkal","hex":"#DD3444","lab":[49.79251701639629,64.57344504816842,32.189301051581445],"enabled":true},{"name":"Raspberry pink","code":"S06/R06","special":"","type":"Artkal","hex":"#EB66BE","lab":[62.40841604033713,61.05083378513443,-21.27409557066653],"enabled":true},{"name":"Gray 2","code":"S07/R07","special":"","type":"Artkal","hex":"#8E8F93","lab":[59.4363963494891,0.43126722900932446,-2.253574241419809],"enabled":true},{"name":"Emerald","code":"S08/R08","special":"","type":"Artkal","hex":"#52CC6A","lab":[73.55862511203907,-54.63187398213803,38.74820732078321],"enabled":true},{"name":"Dark Green","code":"S09/R09","special":"","type":"Artkal","hex":"#2A5D62","lab":[36.37182801444546,-15.423433298190764,-8.081698294547513],"enabled":true},{"name":"Baby Blue","code":"S10/R10","special":"","type":"Artkal","hex":"#61A8DF","lab":[66.42381745378658,-6.530084675218761,-34.54842343913149],"enabled":true},{"name":"Dark Blue","code":"S11/R11","special":"","type":"Artkal","hex":"#284492","lab":[31.021619809374606,17.628286191076537,-46.18885648429788],"enabled":true},{"name":"Pastel Lavender","code":"S12/R12","special":"","type":"Artkal","hex":"#8962AD","lab":[48.3491960833875,30.68029452007076,-34.245924276326576],"enabled":true},{"name":"Black","code":"S13/R13","special":"","type":"Artkal","hex":"#1F1F21","lab":[11.831167901730321,0.5124530370343855,-1.360581645423825],"enabled":true},{"name":"Sandstorm","code":"S14/R14","special":"","type":"Artkal","hex":"#EFDD06","lab":[87.03450510101607,-11.684287112206038,86.0538311900428],"enabled":true},{"name":"Redwood","code":"S15/R15","special":"","type":"Artkal","hex":"#7C4545","lab":[35.928401635394074,23.573878300553407,10.357580844427638],"enabled":true},{"name":"Brown","code":"S16/R16","special":"","type":"Artkal","hex":"#78584E","lab":[40.44703988431715,11.710772962930966,10.959119847505372],"enabled":true},{"name":"light brown","code":"S17/R17","special":"","type":"Artkal","hex":"#594743","lab":[31.887751053135048,6.955883894545489,5.296242933709916],"enabled":true},{"name":"Sand","code":"S18/R18","special":"","type":"Artkal","hex":"#CE9B86","lab":[68.23067983254748,16.190463510188657,18.409686609497157],"enabled":true},{"name":"Bubblegum","code":"S19/R19","special":"","type":"Artkal","hex":"#EDAEAC","lab":[76.83332976817825,22.750825038188427,10.104311395229558],"enabled":true},{"name":"Green","code":"S20/R20","special":"","type":"Artkal","hex":"#549160","lab":[55.05187948971573,-30.798426453306995,19.985958311749606],"enabled":true},{"name":"Pastel Green","code":"S21/R21","special":"","type":"Artkal","hex":"#84C551","lab":[73.17552080825524,-40.32500070715744,50.637229851490304],"enabled":true},{"name":"Purple","code":"S22/R22","special":"","type":"Artkal","hex":"#554889","lab":[34.74624992996755,21.779523507824,-34.52448442322535],"enabled":true},{"name":"Royal Purple","code":"S23/R23","special":"","type":"Artkal","hex":"#7D66AD","lab":[48.10828420722139,24.746193013611585,-34.70878176415031],"enabled":true},{"name":"True Blue","code":"S24/R24","special":"","type":"Artkal","hex":"#396DBC","lab":[46.22832438304233,9.185796262260016,-46.70206198696487],"enabled":true},{"name":"Hot Pink","code":"S25/R25","special":"","type":"Artkal","hex":"#FE5BBA","lab":[63.42393916158464,70.43011241481595,-17.188784825361193],"enabled":true},{"name":"Magenta","code":"S26/R26","special":"","type":"Artkal","hex":"#FE4289","lab":[58.76399728482538,74.07078942727053,4.285475151074558],"enabled":true},{"name":"Yellow","code":"S27/R27","special":"","type":"Artkal","hex":"#F0CE01","lab":[83.26848227078787,-3.7539280471771685,83.81342318727032],"enabled":true},{"name":"Lily Pink","code":"S28/R28","special":"","type":"Artkal","hex":"#DF9FCD","lab":[72.820741760897,30.88142322866444,-14.031563613402076],"enabled":true},{"name":"Pastel Yellow","code":"S29/R29","special":"","type":"Artkal","hex":"#F0E24F","lab":[88.67732408561957,-11.71462594269057,70.34977525044475],"enabled":true},{"name":"Shadow Green","code":"S30/R30","special":"","type":"Artkal","hex":"#A1C6CE","lab":[77.5321766929451,-10.49980545785062,-8.071406859209706],"enabled":true},{"name":"Sea Mist","code":"S31/R31","special":"","type":"Artkal","hex":"#ABDACA","lab":[83.4765682214534,-18.463561783233608,2.8664342859066716],"enabled":true},{"name":"Beeswax","code":"S32/R32","special":"","type":"Artkal","hex":"#F8C583","lab":[82.66159102657682,10.164196914760893,39.90623235540605],"enabled":true},{"name":"Maverick","code":"S33/R33","special":"","type":"Artkal","hex":"#C0AEDB","lab":[73.92870762655919,15.087841881987584,-20.31019136849008],"enabled":true},{"name":"Mona Lisa","code":"S35/R35","special":"","type":"Artkal","hex":"#F9BCC1","lab":[81.81450229762594,22.65533748213744,6.04531145278997],"enabled":true},{"name":"Old Pink","code":"S36/R36","special":"","type":"Artkal","hex":"#C86782","lab":[55.67651587654031,41.399170751538485,2.8523241303597624],"enabled":true},{"name":"Blue Green","code":"S37/R37","special":"","type":"Artkal","hex":"#84C7C6","lab":[75.96455025111285,-21.29223688333687,-6.250813954561307],"enabled":true},{"name":"burgundy","code":"S38/R38","special":"","type":"Artkal","hex":"#A13053","lab":[38.402829748210046,48.95406582523379,5.8392761015293555],"enabled":true},{"name":"Yellow Orange","code":"S39/R39","special":"","type":"Artkal","hex":"#FF834B","lab":[68.02105633948781,43.145864849733876,50.81236241244448],"enabled":true},{"name":"Carnation Pink","code":"S40/R40","special":"","type":"Artkal","hex":"#FD91D6","lab":[73.53806150252083,49.4819512338851,-17.566819316394966],"enabled":true},{"name":"Copper","code":"S41/R41","special":"Metal","type":"Artkal","hex":"#9D5B2E","lab":[45.424649879127216,23.106864941053075,36.784024838005244],"enabled":true},{"name":"Silver","code":"S42/R42","special":"Metal","type":"Artkal","hex":"#676B73","lab":[45.132614162528576,0.21401470479109896,-4.991028843899747],"enabled":true},{"name":"Gray 3","code":"S43/R43","special":"","type":"Artkal","hex":"#66676A","lab":[43.603809813642876,0.2474351031907518,-1.8264519243970767],"enabled":true},{"name":"Sky Blue","code":"S44/R44","special":"","type":"Artkal","hex":"#A4C8E8","lab":[79.05696762173588,-4.680917636432024,-19.758013470495726],"enabled":true},{"name":"Medium Turquoise","code":"S45/R45","special":"","type":"Artkal","hex":"#3F989E","lab":[58.01982419729117,-24.408890895526337,-11.107007967304995],"enabled":true},{"name":"Bright Green","code":"S46/R46","special":"","type":"Artkal","hex":"#A8E42A","lab":[83.95473219602758,-43.14421631674764,75.90537710774704],"enabled":true},{"name":"Marigold","code":"S47/R47","special":"","type":"Artkal","hex":"#9C743C","lab":[51.70687932653702,9.330054693217571,36.54563099614716],"enabled":true},{"name":"Corn","code":"S48/R48","special":"","type":"Artkal","hex":"#F6BF05","lab":[80.10382333992577,6.576630509296743,81.46693033116942],"enabled":true},{"name":"Mulberry Wood","code":"S49/R49","special":"","type":"Artkal","hex":"#78315A","lab":[31.64216077252368,35.993500913978046,-9.417685969246936],"enabled":true},{"name":"Mandys Pink","code":"S50/R50","special":"","type":"Artkal","hex":"#FDA47E","lab":[75.41393813560697,28.971499912632424,33.28937852337095],"enabled":true},{"name":"Spring Sun","code":"S51/R51","special":"","type":"Artkal","hex":"#F3D9B6","lab":[87.99640093418192,3.742371654771204,20.542556544097778],"enabled":true},{"name":"Picasso","code":"S52/R52","special":"","type":"Artkal","hex":"#EFE56D","lab":[89.62363813552035,-11.67103997324176,58.76394765862318],"enabled":true},{"name":"Turquoise","code":"S53/R53","special":"","type":"Artkal","hex":"#6593DF","lab":[60.74794637987574,6.259918829848388,-43.412066128017514],"enabled":true},{"name":"Light Blue","code":"S54/R54","special":"","type":"Artkal","hex":"#1A75D0","lab":[48.87933372010998,8.39363897368689,-53.99314632905827],"enabled":true},{"name":"Pistachio","code":"S55/R57","special":"","type":"Artkal","hex":"#A0D589","lab":[80.10542008671726,-30.98632633883014,32.19260025034749],"enabled":true},{"name":"Outrageous Orange","code":"S56/R59","special":"","type":"Artkal","hex":"#FE7F50","lab":[67.14836117610032,44.98792234013621,47.290403903766546],"enabled":true},{"name":"Buccaneer","code":"S57/R63","special":"","type":"Artkal","hex":"#984E43","lab":[42.04547689903041,29.77394372178527,20.53784361136668],"enabled":true},{"name":"Paprika","code":"S58/R64","special":"","type":"Artkal","hex":"#AC2C44","lab":[39.56256997214207,52.64070122869402,17.269708210306444],"enabled":true},{"name":"Lavender","code":"S60/R66","special":"","type":"Artkal","hex":"#A675BF","lab":[56.67487930888802,32.728085178220404,-31.406144386121237],"enabled":true},{"name":"Key Lemon Pie","code":"S61/R68","special":"","type":"Artkal","hex":"#BBC528","lab":[76.46681644983448,-21.256220026484197,70.3129177045977],"enabled":true},{"name":"Green Tea","code":"S62/R69","special":"","type":"Artkal","hex":"#387061","lab":[43.20020229749558,-22.46051295460913,2.661911418456109],"enabled":true},{"name":"Metallic Gold","code":"S63/R70","special":"","type":"Artkal","hex":"#696046","lab":[40.91445973598478,-0.8194899576548231,16.186549285504793],"enabled":true},{"name":"Black Rock","code":"S64/R55","special":"","type":"Artkal","hex":"#363D5C","lab":[26.43195291075412,5.9603063178852995,-19.421584785694236],"enabled":true},{"name":"Canary","code":"S65/R58","special":"","type":"Artkal","hex":"#F7F839","lab":[94.82491375420213,-20.503981040099927,83.65142861050656],"enabled":true},{"name":"Blaze Orange","code":"S66/R70","special":"","type":"Artkal","hex":"#FD5143","lab":[59.133889681270915,64.29019750345493,45.04211061354636],"enabled":true},{"name":"Vanilla","code":"S67/R61","special":"","type":"Artkal","hex":"#E2C1B2","lab":[80.47288044610875,9.409090809019748,11.88755724407493],"enabled":true},{"name":"Tan","code":"S68","special":"","type":"Artkal","hex":"#AF9666","lab":[63.24852061379531,2.5254100082814923,28.747195479064146],"enabled":true},{"name":"Mine Shaft","code":"S69","special":"","type":"Artkal","hex":"#43484E","lab":[30.346965556604147,-0.6051444026306252,-4.282876018041081],"enabled":true},{"name":"Dark Algae","code":"S70","special":"","type":"Artkal","hex":"#92B701","lab":[69.45539481821476,-32.537883900636444,70.27695123474723],"enabled":true},{"name":"Jade Green","code":"S71","special":"","type":"Artkal","hex":"#318332","lab":[48.40568461124187,-41.89386242748944,35.80751759550075],"enabled":true},{"name":"Light Sea Blue","code":"S72","special":"","type":"Artkal","hex":"#77BFD1","lab":[73.40710331562441,-17.851747377096494,-16.105462231748202],"enabled":true},{"name":"Steel blue","code":"S73","special":"","type":"Artkal","hex":"#5B9FC7","lab":[62.62895716040964,-10.147494905393629,-27.13449830690191],"enabled":true},{"name":"azure","code":"S74","special":"","type":"Artkal","hex":"#4090C0","lab":[56.92142152232901,-9.18374953743617,-32.118347044426265],"enabled":true},{"name":"dark steel blue","code":"S75","special":"","type":"Artkal","hex":"#3879A6","lab":[48.59679369123748,-6.14055423421922,-30.175463431567717],"enabled":true},{"name":"sea blue","code":"S76","special":"","type":"Artkal","hex":"#3B87AB","lab":[53.165544846883876,-11.964960073092612,-25.96731995891006],"enabled":true},{"name":"Ghost white","code":"S77","special":"","type":"Artkal","hex":"#D3D3D0","lab":[84.47934646750483,-0.5359773431525827,1.4725724940607643],"enabled":true},{"name":"Ash Gray","code":"S78","special":"","type":"Artkal","hex":"#BDBDBB","lab":[76.55883401650435,-0.36428636798852,0.9997650954350457],"enabled":true},{"name":"Gray 1","code":"S79","special":"","type":"Artkal","hex":"#A3A7A9","lab":[68.23273645136732,-1.0261695529008574,-1.533910555096174],"enabled":true},{"name":"Dark Olive","code":"S80","special":"","type":"Artkal","hex":"#7C8934","lab":[54.4743715364216,-17.28891291507334,42.805158927754384],"enabled":true},{"name":"Deer","code":"S81","special":"","type":"Artkal","hex":"#B88A62","lab":[61.00088618003821,12.49621628366887,28.188044674875744],"enabled":true},{"name":"Clay","code":"S82","special":"","type":"Artkal","hex":"#916A4D","lab":[48.08775104097808,11.796043898473329,22.359083750224727],"enabled":true},{"name":"Sienna","code":"S83","special":"","type":"Artkal","hex":"#AE6735","lab":[50.635932085372445,24.120800862911906,39.561449363364844],"enabled":true},{"name":"Deep Chestnut","code":"S84","special":"","type":"Artkal","hex":"#A55761","lab":[46.55021960963596,33.05561330740592,8.79963531794765],"enabled":true},{"name":"Red Wine","code":"S85","special":"","type":"Artkal","hex":"#8C414A","lab":[37.572685504024115,32.77355936224408,9.857148486345702],"enabled":true},{"name":"Goldenrod","code":"S86","special":"","type":"Artkal","hex":"#E9B504","lab":[76.30200696050936,6.177210987933557,78.28011172214316],"enabled":true},{"name":"Coral Red","code":"S87","special":"","type":"Artkal","hex":"#FA616A","lab":[61.579939121240756,59.02023402485146,26.128946726764735],"enabled":true},{"name":"Dark Pink","code":"S88","special":"","type":"Artkal","hex":"#D93B80","lab":[51.19593609903001,65.56103469046559,-2.1726393023545176],"enabled":true},{"name":"Gray 4","code":"S89","special":"","type":"Artkal","hex":"#585C63","lab":[38.949919404579944,0.0033161993001906698,-4.551474347336814],"enabled":true},{"name":"Pastel Orange","code":"S90","special":"","type":"Artkal","hex":"#FBB749","lab":[78.95896615549638,14.596712134014977,63.16520561046146],"enabled":true},{"name":"Brunswick Green","code":"S91","special":"","type":"Artkal","hex":"#344042","lab":[26.12849830275283,-4.358104336808638,-2.857251366140323],"enabled":true},{"name":"Glow Yellow","code":"SG1/RG1","special":"Glow","type":"Artkal","hex":"#C6C0B4","lab":[77.87519272823928,0.0035787152996569205,6.780787007378408],"enabled":true},{"name":"Glow Pink","code":"SG2/RG2","special":"Glow","type":"Artkal","hex":"##VALUE!","lab":[null,null,null],"enabled":true},{"name":"Glow Blue","code":"SG3/RG3","special":"Glow","type":"Artkal","hex":"#6FADC1","lab":[67.36464418654856,-14.695525489691663,-16.485501553757477],"enabled":true},{"name":"Glitter Blue","code":"SL1/RL1","special":"Glitter","type":"Artkal","hex":"#3687B2","lab":[53.30506597805194,-10.425621080441427,-29.787231851615847],"enabled":true},{"name":"Glitter Green","code":"SL2/RL2","special":"Glitter","type":"Artkal","hex":"#117C52","lab":[45.83034973276081,-38.93624434997575,15.083719056342348],"enabled":true},{"name":"Glitter Red","code":"SL3/RL3","special":"Glitter","type":"Artkal","hex":"#C22933","lab":[43.203268162598754,59.24872859542457,33.1725519848146],"enabled":true},{"name":"Glitter Yellow","code":"SL4/RL4","special":"Glitter","type":"Artkal","hex":"#CDBD00","lab":[75.68361346933841,-10.240222212633544,77.03411612637574],"enabled":true},{"name":"Neon Orange","code":"SN1","special":"","type":"Artkal","hex":"#FF7405","lab":[64.77300892158122,48.66091244800314,71.92426571749765],"enabled":true},{"name":"Neon Green","code":"SN2","special":"","type":"Artkal","hex":"#01C63E","lab":[69.99507863454136,-68.03241143409672,54.25041933567497],"enabled":true},{"name":"Neon Yellow","code":"SN3","special":"","type":"Artkal","hex":"#F2F33C","lab":[93.14766409886293,-20.042560338690674,81.14526351431515],"enabled":true},{"name":"Neon Rose","code":"SN4","special":"","type":"Artkal","hex":"#FF477A","lab":[59.13284225483953,71.55631665298345,13.657583164270681],"enabled":true},{"name":"Pearlescent Green","code":"SP1/RP1","special":"Pearl","type":"Artkal","hex":"#93CA87","lab":[76.18779986123033,-30.55567112597529,27.89490382789075],"enabled":true},{"name":"Pearlescent Tangerine","code":"SP2/RP2","special":"Pearl","type":"Artkal","hex":"#FE7F54","lab":[67.19417196724616,45.200259474381724,45.28709955138297],"enabled":true},{"name":"Pearlescent Orange","code":"SP3/RP3","special":"Pearl","type":"Artkal","hex":"#F0A149","lab":[72.55881258582947,21.592256278444964,56.10324975420996],"enabled":true},{"name":"Pearlescent Pink","code":"SP4/RP4","special":"Pearl","type":"Artkal","hex":"#DC9EA9","lab":[71.23749394405597,24.631247705023675,3.483378542045168],"enabled":true},{"name":"Pearlescent Red","code":"SP5/RP5","special":"Pearl","type":"Artkal","hex":"#D63C53","lab":[49.680423529062395,60.73045509349517,22.831745334538876],"enabled":true},{"name":"Pearlescent Blue","code":"SP6/RP6","special":"Pearl","type":"Artkal","hex":"#2C4E97","lab":[34.43409498821668,13.416935321938661,-43.72190679548681],"enabled":true},{"name":"Pearlescent Purple","code":"SP7/RP7","special":"Pearl","type":"Artkal","hex":"#64427E","lab":[34.215290604659884,26.992569949114753,-28.471179530698343],"enabled":true},{"name":"Pearlescent White","code":"SP8","special":"Pearl","type":"Artkal","hex":"#E0DBCA","lab":[87.37538140197981,-1.1876782124043417,8.954237858810243],"enabled":true},{"name":"Transparent","code":"ST1/RT1","special":"Transp","type":"Artkal","hex":"#C7BCB8","lab":[77.02255142030987,3.173642887735195,3.3982509951119955],"enabled":true},{"name":"Transparent Pink","code":"ST2/RT2","special":"Transp","type":"Artkal","hex":"#F95498","lab":[60.5580320084177,67.91712073422812,-1.978463159976207],"enabled":true},{"name":"Transparent Tangering","code":"ST3/RT3","special":"Transp","type":"Artkal","hex":"#FF7C45","lab":[66.6000549816692,46.301773781724506,52.21136893018519],"enabled":true},{"name":"Transparent Yellow","code":"ST4/RT4","special":"Transp","type":"Artkal","hex":"#DADF3D","lab":[86.01529847636205,-20.197096504921632,73.55737915259273],"enabled":true}],
      _cache : {},
      findClosest : function(r,g,b){
        var id = r + "-" + g + "-" + b,
        lab1,
        index = -1,
        minDist = 10000000,
        dist,
        lab2;
        if(this._cache.hasOwnProperty(id)){
          return this._cache[id];
        }
        lab1 = this.rgbToLab(r,g,b);
        for(var i = 0; i < this.palette.length; ++i){
          if(this.palette[i].enabled){
            lab2 = this.palette[i].lab;
            dist = this.deltaE00(lab1[0],lab1[1],lab1[2], lab2[0],lab2[1],lab2[2]);
            if(dist <= minDist){
              index = i;
              minDist = dist;
            }
          }
        }
        this._cache[id] = index;
        return index;
      },

      rgbToLab : function(r, g, b){
        var fr = r / 255.0,
            fg = g / 255.0,
            fb = b / 255.0,
            x,y,z, L,a,b;

            if(fr > 0.04045){
              fr = Math.pow(((fr + 0.055) / 1.055), 2.2);
            } else {
              fr = fr / 12.92;
            }
            if(fg > 0.04045){
              fg = Math.pow(((fg + 0.055) / 1.055), 2.2);
            } else {
              fg = fg / 12.92;
            }
            if(fb > 0.04045){
              fb = Math.pow(((fb + 0.055) / 1.055), 2.2);
            } else {
              fb = fb / 12.92;
            }

            fr = fr * 100.0;
            fg = fg * 100.0;
            fb = fb * 100.0;

            x = fr * 0.4124 + fg * 0.3576 + fb * 0.1805;
            y = fr * 0.2126 + fg * 0.7152 + fb * 0.0722;
            z = fr * 0.0193 + fg * 0.1192 + fb * 0.9505;

            x = x / 95.047;
            y = y / 100.0;
            z = z / 108.883;


            if ( x > 0.008856 ){
              x = Math.pow(x,( 1.0/3.0 ));
            } else {
              x = ( 7.787 * x ) + ( 16.0 / 116.0 );
            };
            if ( y > 0.008856 ){
              y = Math.pow(y,( 1.0/3.0 ));
            } else {
              y = ( 7.787 * y ) + ( 16.0 / 116.0 );
            };
            if ( z > 0.008856 ){
              z = Math.pow(z,( 1.0/3.0 ));
            } else {
              z = ( 7.787 * z ) + ( 16.0 / 116.0 );
            };

            L = (116 * y) - 16;
            a = 500 * (x - y);
            b = 200 * (y - z);

            return [L, a, b];
      },

      toDegrees : function (angle) {
          return angle * (180 / Math.PI);
      },

      toRad : function (num) {
          return num * Math.PI / 180;
      },

      deltaE00 : function(L1, a1, b1, L2, a2, b2){
        var k_L =1.0,
            k_C = 1.0,
            k_H = 1.0,
            C1 = Math.sqrt(Math.pow(a1,2) + Math.pow(b1,2)),
            C2 = Math.sqrt(Math.pow(a2,2) + Math.pow(b2,2)),
            C_avr = (C1 + C2) / 2.0,
            G = 0.5 * (1.0 - Math.sqrt(Math.pow(C_avr,7)/(Math.pow(C_avr,7) + Math.pow(25,7)))),
            a1_1 = (1 + G) * a1,
            a2_1 = (1 + G) * a2,
            C1_1 = Math.sqrt(Math.pow(a1_1, 2) + Math.pow(b1, 2)),
            C2_1 = Math.sqrt(Math.pow(a2_1, 2) + Math.pow(b2, 2)),
            h1, h2,
            deltah, deltaH,
            deltaL, deltaC,
            L_av, C_1_av,
            hDiff,
            L_av_m50,
            SL, SC, T, SH, dTheta, RC, RT,
            dkL, dkC, dkH,
            result;

            // add h' for both colors
            if (a1_1 === 0 && b1 === 0) {
              h1 = 0;
            } else {
              if (b1 >= 0) {
                h1 = this.toDegrees(Math.atan2(b1, a1_1));
              } else {
                h1 = this.toDegrees(Math.atan2(b1, a1_1)) + 360;
              }
            }
            if (a2_1 === 0 && b2 === 0) {
              h2 = 0;
            } else {
              if (b2 >= 0) {
                h2 = this.toDegrees(Math.atan2(b2, a2_1));
              } else {
                h2 = this.toDegrees(Math.atan2(b2, a2_1)) + 360;
              }
            }

            if ((C1_1 * C2_1) === 0) {
              deltah = 0;
            } else {
              if (Math.abs(h2 - h1) <= 180) {
                deltah = h2 - h1;
              } else {
                if (h2 - h1 > 180) {
                  deltah = h2 - h1 - 360;
                } else {
                  deltah = h2 - h1 + 360;
                }
              }
            }
            deltaH = 2 * Math.sqrt(C1_1 * C2_1) * Math.sin(this.toRad(deltah / 2));
            deltaL = L1 - L2;
            deltaC = C2_1 - C1_1;

            L_av = (L1 + L2) / 2;
            C_1_av = (C1_1 + C2_1) / 2;

            if ((C1_1 * C2_1) === 0) {
              hDiff = h1 + h2;
            } else {
              if (Math.abs(h2 - h1) > 180) {
                if ((h2 + h1) < 360) {
                  hDiff = h1 + h2 + 360;
                } else {
                  hDiff = h1 + h2 - 360;
                }
              } else {
                hDiff = h1 + h2;
              }
              hDiff = hDiff / 2;
            }

            L_av_m50 =  Math.pow((L_av - 50), 2);
            SL = 1 + ((0.015 * L_av_m50) / Math.sqrt(20 + L_av_m50));
            SC = 1 + 0.045 * C_1_av;
            T = 1 - 0.17 * Math.cos(this.toRad(hDiff - 30)) + 0.24 * Math.cos(this.toRad(2 * hDiff)) + 0.32 * Math.cos(this.toRad(3 * hDiff + 6)) - 0.20 * Math.cos(this.toRad(4 * hDiff - 63));
            SH = 1 + 0.015 * C_1_av * T;
            dTheta = 30 * Math.exp(-1 * Math.pow((hDiff - 275) / 25, 2));
            RC = 2 * Math.sqrt(Math.pow(C_1_av, 7) / (Math.pow(C_1_av, 7) + Math.pow(25, 7)));
            RT = 0 - Math.sin(this.toRad(2 * dTheta)) * RC;

            dkL = deltaL / (k_L * SL);
            dkC = deltaC / (k_C * SC);
            dkH = deltaH / (k_H * SH);

            result = Math.sqrt(Math.pow(dkL, 2) + Math.pow(dkC, 2) + Math.pow(dkH, 2) + RT * dkC * dkH);

            return result;
      },

      getBeadData : function(index){
        return this.palette[index];
      },

      switchIndex : function (i, enabled) {
        if(i < this.palette.length){
          this.palette[i].enabled = enabled;
        }
      },
      switchTypes : function (types, enabled) {
        this.palette.forEach(function(color){
          if(types.indexOf(color.type) > -1){
            color.enabled = enabled;
          }
        });
      },
      switchSpecials : function (specials, enabled) {
        this.palette.forEach(function(color){
          if(specials.indexOf(color.special) > -1){
            color.enabled = enabled;
          }
        });
      },
      getPaletteSize : function(){
        return this.palette.length;
      }
    };
    return BeadManager;
}]);
